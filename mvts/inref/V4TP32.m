V4TP32 ;IW-KO-YS-TS,VV4TP,MVTS V9.10;15/7/96;PART-94 Transaction
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1994-1996
 ;
 W !!,"154---V4TP32: 3 Transactions tests -2-"
 ;
1 S ^ABSN="40922",^ITEM="IV-922  1. TSTART ():SERIAL  ... TCOMMIT!2. TSTART *:S  ... TRESTART ... TCOMMIT!3. TSTART lname:(S)  ... TROLLBACK"
 S ^NEXT="2^V4TP32,END^VV4TP" D ^V4PRETP3
 JOB 11^V4TPE32::60 S WAIT=WAIT_$T
 JOB 12^V4TPE32::60 S WAIT=WAIT_$T
 JOB 13^V4TPE32::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1 LOCK -^V(3) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VC^VD(1)VCVD(1)10/#1^VC^VC(1,2)^VD^VD(1)VA(1)VC00/#2^VA^VB(1)VAVB(1)10/#2^VA^VB(1)VAVB(1)11/#2^VA^va^VB(1)^vb(1)00/#3^VA^va^VA^VB(1)^vb(1)^VB(1)VAVB(1)10/#3^VA^va^VB(1)^vb(1)VAVB(1)00/*1111/#M^VA^va^VB(1)^vb(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
2 S ^ABSN="40923",^ITEM="IV-923  1. TSTART (lname,lname):S  ... TRESTART ... TROLLBACK!2. TSTART (lname,lname):S  ... TROLLBACK!3. TSTART lname:S  ... TRESTART ... TCOMMIT"
 S ^NEXT="END^VV4TP" D ^V4PRETP3
 JOB 21^V4TPE32::60 S WAIT=WAIT_$T
 JOB 22^V4TPE32::60 S WAIT=WAIT_$T
 JOB 23^V4TPE32::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1 LOCK -^V(3) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VC^VD(1)10/#111/#1^VA11/#1^VA00/#2^VA^VC^VD(1)VCVD(1)10/#2^VAVCVD(1)00/#3^VA^VA^VB(1)^VC^VD(1)VAVB(1)VCVD(1)10/#3^VAVAVCVD(1)11/#3^VA^VC11/#3^VA^VC00/*1111/#M^VA^VC00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
END W !!,"End of 154 --- V4TP32",!
 Q
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
