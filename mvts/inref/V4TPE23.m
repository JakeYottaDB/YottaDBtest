V4TPE23 ;IW-KO-YS-TS,VV4TP,MVTS V9.10;15/7/96;PART-94 Transaction
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1994-1996
11 ;---TSTART lname:SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS1
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 TSTART VA:SERIAL
 IF $TRESTART G 2311
 S ^VA(1,2)="^VA(1,2)",^VB(2)="^VB(2)",VB(2)="VB(2)",VC(1)="VC(1)" K VD
 D ^V4TPCHK1
 TRESTART
 TCOMMIT
 D ^V4TPCHK1
 L  H
2311 D ^V4TPCHK1
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 TCOMMIT
 D ^V4TPCHK1
 L  H
 ;
12 ;---TSTART lname  ... TCOMMIT
 F  Q:$$^V4GETS2
 TSTART VA
 D ^V4TPS22 ;^VC^VD(1)VCVD(1)
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK2
 TCOMMIT
 D ^V4TPCHK2
 L  H
 ;
 ;==========================================
21 ;---1. TSTART (lname,lname):SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS1
 D ^V4TPS22 ;^VC^VD(1)VCVD(1)
 TSTART (VA,VC):SERIAL
 IF $TRESTART G 2321
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK1
 TRESTART
 TCOMMIT
 D ^V4TPCHK1
 L  H
2321 D ^V4TPCHK1
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 TCOMMIT
 D ^V4TPCHK1
 L  H
 ;
22 ;---2. TSTART *  ... TROLLBACK
 F  Q:$$^V4GETS2
 TSTART *
 D ^V4TPS3 ;^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)
 D ^V4TPCHK2
 TROLLBACK
 D ^V4TPCHK2
 L  H
 ;==========================================
31 ;---1. TSTART *:SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS1
 D ^V4TPS3 ;^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)
 TSTART *:SERIAL
 IF $TRESTART G 2331
 K  K ^VB S ^VA(2)="^VA(2)"
 D ^V4TPCHK1
 TRESTART
 TCOMMIT
 D ^V4TPCHK1
 L  H
2331 D ^V4TPCHK1
 TCOMMIT
 D ^V4TPCHK1
 L  H
 ;
32 ;---2. TSTART ()  ... TROLLBACK
 F  Q:$$^V4GETS2
 TSTART ()
 D ^V4TPS22 ;^VC^VD(1)VCVD(1)
 D ^V4TPCHK2
 TROLLBACK
 D ^V4TPCHK2
 L  H
 ;==========================================
41 ;---1. TSTART ():SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS1
 TSTART ():SERIAL
 IF $TRESTART G 2341
 D ^V4TPS3 ;^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)
 D ^V4TPCHK1
 TRESTART
 D ^V4TPS4 ;^va(1)^vb(2)^vc(1,2)^vd(2)va(1)vb(2)vc(1,2)vd(2)
 TCOMMIT
 D ^V4TPCHK1
 L  H
2341 D ^V4TPCHK1
 TCOMMIT
 D ^V4TPCHK1
 L  H
 ;
42 ;---2. TSTART (lname,lname) ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS2
 TSTART (AC,AB)
 IF $TRESTART G 2342
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK2
 TRESTART
 TCOMMIT
 D ^V4TPCHK2
 L  H
2342 D ^V4TPCHK2
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 TCOMMIT
 D ^V4TPCHK2
 L  H
 ;==========================================
51 ;---1. TSTART *:SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS1
 TSTART *:SERIAL
 IF $TRESTART G 2351
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK1
 TRESTART
 TCOMMIT
 D ^V4TPCHK1
 L  H
2351 D ^V4TPCHK1
 D ^V4TPS4 ;^va(1)^vb(2)^vc(1,2)^vd(2)va(1)vb(2)vc(1,2)vd(2)
 TCOMMIT
 D ^V4TPCHK1
 L  H
 ;
52 ;---2. TSTART lname:SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS2
 TSTART VB:SERIAL
 IF $TRESTART G 2352
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK2
 TRESTART
 TCOMMIT
 D ^V4TPCHK2
 L  H
2352 D ^V4TPCHK2
 D ^V4TPS22 ;^VC^VD(1)VCVD(1)
 TCOMMIT
 D ^V4TPCHK2
 L  H
 ;
 ;==========================================
61 ;---1. TSTART ():SERIAL  ... TRESTART ... TCOMMIT
 F  Q:$$^V4GETS1
 TSTART ():SERIAL
 IF $TRESTART G 2361
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK1
 TRESTART
 TCOMMIT
 D ^V4TPCHK1
 L  H
2361 D ^V4TPCHK1
 D ^V4TPS4 ;^va(1)^vb(2)^vc(1,2)^vd(2)va(1)vb(2)vc(1,2)vd(2)
 TCOMMIT
 D ^V4TPCHK1
 L  H
 ;
62 ;---2. TSTART lname:SERIAL  ... TRESTART ... TROLLBACK
 F  Q:$$^V4GETS2
 TSTART VC:SERIAL
 IF $TRESTART G 2362
 D ^V4TPS21 ;^VA^VB(1)VAVB(1)
 D ^V4TPCHK2
 TRESTART
 TCOMMIT
 D ^V4TPCHK2
 L  H
2362 D ^V4TPCHK2
 D ^V4TPS22 ;^VC^VD(1)VCVD(1)
 TROLLBACK
 D ^V4TPCHK2
 L  H
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
