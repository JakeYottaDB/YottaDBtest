V4TP23 ;IW-KO-YS-TS,VV4TP,MVTS V9.10;15/7/96;PART-94 Transaction
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1994-1996
 ;
 W !!,"151---V4TP23: 2 Transactions tests  -3-"
 ;
 W !!,"TSTART with transparameters"
 W !,"   with a restart before TCOMMIT or TROLLBACK",!
 ;
1 S ^ABSN="40909",^ITEM="IV-909  1. TSTART lname:SERIAL  ... TRESTART ... TCOMMIT!2. TSTART lname  ... TCOMMIT"
 S ^NEXT="2^V4TP23,V4TP24^VV4TP" D ^V4PRETP2
 JOB 11^V4TPE23::60 S WAIT=WAIT_$T
 JOB 12^V4TPE23::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VA(1,2)^VB(1)^VB(2)VAVB(1)VB(2)VC(1)10/#1^VA^VB(1)VAVB(1)VB(2)VC(1)11/#1^VA^VA^VB(1)^VB(1)VAVAVB(1)VB(1)VB(2)VC(1)00/#2^VA^VA^VA^VB(1)^VB(1)^VB(1)^VC^VD(1)VAVB(1)VCVD(1)10/#2^VA^VA^VA^VB(1)^VB(1)^VB(1)^VC^VD(1)VAVB(1)VCVD(1)00/*111/#M^VA^VA^VA^VB(1)^VB(1)^VB(1)^VC^VD(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
2 S ^ABSN="40910",^ITEM="IV-910  1. TSTART (lname,lname):SERIAL  ... TRESTART ... TCOMMIT!2. TSTART *  ... TROLLBACK"
 S ^NEXT="3^V4TP23,V4TP24^VV4TP" D ^V4PRETP2
 JOB 21^V4TPE23::60 S WAIT=WAIT_$T
 JOB 22^V4TPE23::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)^VC^VD(1)VAVB(1)VCVD(1)10/#1^VC^VD(1)VB(1)VCVD(1)11/#1^VA^VB(1)^VC^VD(1)VAVB(1)VB(1)VCVD(1)00/#2^VA^VA(1)^VB(1)^VB(1,2)^VC^VC(2)^VD(1)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)10/#2^VA^VB(1)^VC^VD(1)VA(1)VB(1,2)VC(2)VD(1,2)00/*111/#M^VA^VB(1)^VC^VD(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
3 S ^ABSN="40911",^ITEM="IV-911  1. TSTART *:SERIAL  ... TRESTART ... TCOMMIT!2. TSTART ()  ... TROLLBACK"
 S ^NEXT="4^V4TP23,V4TP24^VV4TP" D ^V4PRETP2
 JOB 31^V4TPE23::60 S WAIT=WAIT_$T
 JOB 32^V4TPE23::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA(1)^VA(2)^VC(2)^VD(1,2)10/#1^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)11/#1^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)00/#2^VA(1)^VB(1,2)^VC^VC(2)^VD(1)^VD(1,2)VCVD(1)10/#2^VA(1)^VB(1,2)^VC(2)^VD(1,2)VCVD(1)00/*111/#M^VA(1)^VB(1,2)^VC(2)^VD(1,2)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
4 S ^ABSN="40912",^ITEM="IV-912  1. TSTART ():SERIAL  ... TRESTART ... TCOMMIT!2. TSTART (lname,lname) ... TRESTART ... TCOMMIT"
 S ^NEXT="5^V4TP23,V4TP24^VV4TP" D ^V4PRETP2
 JOB 41^V4TPE23::60 S WAIT=WAIT_$T
 JOB 42^V4TPE23::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)10/#1VA(1)VB(1,2)VC(2)VD(1,2)11/#1VA(1)VB(1,2)VC(2)VD(1,2)00/#2^VA^VB(1)VAVB(1)10/#2VAVB(1)11/#2^VA^VB(1)VAVAVB(1)VB(1)00/*111/#M^VA^VB(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
5 S ^ABSN="40913",^ITEM="IV-913  1. TSTART *:SERIAL  ... TRESTART ... TCOMMIT!2. TSTART lname:SERIAL  ... TRESTART ... TCOMMIT"
 S ^NEXT="6^V4TP23,V4TP24^VV4TP" D ^V4PRETP2
 JOB 51^V4TPE23::60 S WAIT=WAIT_$T
 JOB 52^V4TPE23::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)VAVB(1)10/#111/#1^va(1)^vb(2)^vc(1,2)^vd(2)va(1)vb(2)vc(1,2)vd(2)00/#2^VA^va(1)^VB(1)^vb(2)^vc(1,2)^vd(2)VAVB(1)10/#2^va(1)^vb(2)^vc(1,2)^vd(2)VA11/#2^va(1)^vb(2)^VC^vc(1,2)^VD(1)^vd(2)VAVCVD(1)00/*111/#M^va(1)^vb(2)^VC^vc(1,2)^VD(1)^vd(2)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
6 S ^ABSN="40914",^ITEM="IV-914  1. TSTART ():SERIAL  ... TRESTART ... TCOMMIT!2. TSTART lname:SERIAL  ... TRESTART ... TROLLBACK"
 S ^NEXT="V4TP24^VV4TP" D ^V4PRETP2
 JOB 61^V4TPE23::60 S WAIT=WAIT_$T
 JOB 62^V4TPE23::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)VAVB(1)10/#1VAVB(1)11/#1^va(1)^vb(2)^vc(1,2)^vd(2)VAva(1)VB(1)vb(2)vc(1,2)vd(2)00/#2^VA^va(1)^VB(1)^vb(2)^vc(1,2)^vd(2)VAVB(1)10/#2^va(1)^vb(2)^vc(1,2)^vd(2)VAVB(1)11/#2^va(1)^vb(2)^vc(1,2)^vd(2)VAVB(1)VCVD(1)00/*111/#M^va(1)^vb(2)^vc(1,2)^vd(2)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
END W !!,"End of 151 --- V4TP23",!
 Q
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
