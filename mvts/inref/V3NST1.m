V3NST1 ;IW-KO-YS-TS,VV3,MVTS V9.10;15/6/96;NESTING LEVEL -1-
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1978-1996
 W !!,"       Moved from V1NST1"
 W !!,"28---V3NST1: Nesting ( FOR, XECUTE, DO, @, <FUNCTION> ) -1-"
 W !,"As this routine itself is counted as one level of nesting,"
 W !,"additional 29 levels of nesting are required."
 W !,"Admitted nesting levels are indicated by the number in each test.",!
1 W !,"I,III-337  2 levels of DO, and 28 levels of FOR"
 S ^ABSN="30337",^ITEM="I,III-337  Termination by GOTO" ;(test changed in V8.3;15/2/94)
 S ^NEXT="2^V3NST1,V3NST2^VV3" D ^V3PRESET
 S X="(OK)"
 F A=1:1:2 F B=1:1:2 F C=1:1:2 F D=1:1:2 F E=1:1:2 F F=1:1:2 F G=1:1:2 F H=1:1:2 F I=1:1:2 F J=1:1:2 F K=1:1:2 F L=1:1:2 F M=1:1:2 F N=1:1:2 F O=1:1:2 D NSTFOR I F=2 S ^VCOMP=^VCOMP_X G F2
 S ^VCOMP=^VCOMP_" ERROR 653"
F2 S ^VCORR="(OK)(OK)" D ^VEXAMINE
 ;
2 S ^ABSN="30338",^ITEM="I,III-338  Termination by QUIT" ;(test changed in V8.3;15/2/94)
 S ^NEXT="3^V3NST1,V3NST2^VV3" D ^V3PRESET
 S X="(OK QUIT)",Z=0,Y=0
 F A=1:1:2 Q:Z  F B=1:1:2 Q:Z  F C=1:1:2 Q:Z  F D=1:1:2 Q:Z  F E=1:1:2 Q:Z  F F=1:1:2 Q:Z  F G=1:1:2 Q:Z  F H=1:1:2 Q:Z  F I=1:1:2 Q:Z  F J=1:1:2 Q:Z  F K=1:1:2 Q:Z  F L=1:1:2 Q:Z  F M=1:1:2 Q:Z  F N=1:1:2 Q:Z  F O=1:1:2 D FORDONST I F=2 S ^VCOMP=X,Z=1
 S ^VCORR="(OK QUIT)" D ^VEXAMINE
 ;
3 S ^ABSN="30339",^ITEM="I,III-339  1 level of DO, and 29 levels of XECUTE"
 S ^NEXT="4^V3NST1,V3NST2^VV3" D ^V3PRESET
 S ^VCOMP=""
 S A="X B",B="X C",C="X D",D="X E",E="X F",F="X G",G="X H",H="X I"
 S I="X J",J="X K",K="X L",L="X M",M="X N",N="X O",O="X P",P="X Q"
 S Q="X R",R="X S",S="X T",T="X U",U="X V",V="X W",W="X X",X="X Y"
 S Y="X Z",Z="X A1",A1="X A2",A2="X A3"
 S ZZ=0,A3="S ZZ=ZZ+1 S ^VCOMP=^VCOMP_ZZ"
 X A3,A2,A1,Z,Y,X,W,V,U,T,S,R,Q,P,O,N,M,L,K,I,J,H,G,F,E,D,C,B,A
 S ^VCORR="1234567891011121314151617181920212223242526272829" D ^VEXAMINE
 ;
4 W !,"I,III-340  30 levels of DO"
 S ^ABSN="30340",^ITEM="I,III-340  Local DO"
 S ^NEXT="5^V3NST1,V3NST2^VV3" D ^V3PRESET
 S V="" D D1
 S ^VCOMP=V
 S ^VCORR="1234567891011121314151617181920212223242526272829" D ^VEXAMINE
 ;
5 S ^ABSN="30341",^ITEM="I,III-341  External DO"
 S ^NEXT="6^V3NST1,V3NST2^VV3" D ^V3PRESET
 S V=""
 D D1^V3NSTE
 S ^VCOMP=V,^VCORR="E1E2E3E4E5E6E7E8E9E10E11E12E13E14E15E16E17E18E19E20E21E22E23E24E25E26E27E28E29" D ^VEXAMINE
 ;
6 S ^ABSN="30342",^ITEM="I,III-342  30 levels of combined DO, FOR, XECUTE"
 S ^NEXT="V3NST2^VV3" D ^V3PRESET
 S ^VCOMP="",Z=0
 S G1="D AAAA",G2="X GGG"
 S GGG="F H0=1:1:2 Q:Z  F I0=1:1:2 Q:Z  F H=1:1:2 Q:Z  F I=1:1:2 Q:Z  D JJJ^V3NSTE"
 S MMM="F N=1:1:2 I H=2 S ^VCOMP=""OK"",Z=1"
 F A0=1:1:2 Q:Z  F B0=1:1:2 Q:Z  F A=1:1:2 Q:Z  F B=1:1:2 Q:Z  D C11
 S ^VCORR="OK" D ^VEXAMINE
 ;
END W !!,"End of 28 --- V3NST1",!
 K  Q
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
AAAA X G2 Q
C11 D CC2
 Q
CC2 D CCC Q
CCC Q:Z  F D=1:1:2 Q:Z  F E=1:1:2 Q:Z  F F=1:1:2 F D0=1:1:2 Q:Z  F E0=1:1:2 Q:Z  X G1
 QUIT
NSTFOR F A0=1:1:2 F B0=1:1:2 F C0=1:1:2 F D0=1:1:2 F E0=1:1:2 F F0=1:1:2 F G0=1:1:2 F H0=1:1:2 F I0=1:1:2 F J0=1:1:2 F K0=1:1:2 F L0=1:1:2 F M0=1:1:2 I L0=2 S ^VCOMP=X G NSTFOR2
 S ^VCOMP=^VCOMP_" ERROR 653_2"
NSTFOR2 Q
 ;
FORDONST F A0=1:1:2 Q:Y  F B0=1:1:2 Q:Y  F C0=1:1:2 Q:Y  F D0=1:1:2 Q:Y  F E0=1:1:2 Q:Y  F F0=1:1:2 Q:Y  F G0=1:1:2 Q:Y  F H0=1:1:2 Q:Y  F I0=1:1:2 Q:Y  F J0=1:1:2 Q:Y  F K0=1:1:2 Q:Y  F L0=1:1:2 Q:Y  F M0=1:1:2 Q:Y  I K0=2 S ^VCOMP=X,Y=1
 Q
D6611 S V=V_I_J_" " Q
D1 S V=V_1 D D2 Q
D2 S V=V_2 D D3 Q
D3 S V=V_3 D D4 Q
D4 S V=V_4 D D5 Q
D5 S V=V_5 D D6 Q
D6 S V=V_6 D D7 Q
D7 S V=V_7 D D8 Q
D8 S V=V_8 D D9 Q
D9 S V=V_9 D D10 Q
D10 S V=V_10 D D11 Q
D11 S V=V_11 D D12 Q
D12 S V=V_12 D D13 Q
D13 S V=V_13 D D14 Q
D14 S V=V_14 D D15 Q
D15 S V=V_15 D D16 Q
D16 S V=V_16 D D17 Q
D17 S V=V_17 D D18 Q
D18 S V=V_18 D D19 Q
D19 S V=V_19 D D20 Q
D20 S V=V_20 D D21 Q
D21 S V=V_21 D D22 Q
D22 S V=V_22 D D23 Q
D23 S V=V_23 D D24 Q
D24 S V=V_24 D D25 Q
D25 S V=V_25 D D26 Q
D26 S V=V_26 D D27 Q
D27 S V=V_27 D D28 Q
D28 S V=V_28 D D29 Q
D29 S V=V_29 Q
 ;
ED1 S V=V_"E1" D D2^V3NSTE Q
ED2 S V=V_"E2" D D3^V3NSTE Q
ED3 S V=V_"E3" D D4^V3NSTE Q
ED4 S V=V_"E4" D D5^V3NSTE Q
ED5 S V=V_"E5" D D6^V3NSTE Q
ED6 S V=V_"E6" D D7^V3NSTE Q
ED7 S V=V_"E7" D D8^V3NSTE Q
ED8 S V=V_"E8" D D9^V3NSTE Q
ED9 S V=V_"E9" D D10^V3NSTE Q
ED10 S V=V_"E10" D D11^V3NSTE Q
ED11 S V=V_"E11" D D12^V3NSTE Q
ED12 S V=V_"E12" D D13^V3NSTE Q
ED13 S V=V_"E13" D D14^V3NSTE Q
ED14 S V=V_"E14" D D15^V3NSTE Q
ED15 S V=V_"E15" D D16^V3NSTE Q
ED16 S V=V_"E16" D D17^V3NSTE Q
ED17 S V=V_"E17" D D18^V3NSTE Q
ED18 S V=V_"E18" D D19^V3NSTE Q
ED19 S V=V_"E19" D D20^V3NSTE Q
ED20 S V=V_"E20" D D21^V3NSTE Q
ED21 S V=V_"E21" D D22^V3NSTE Q
ED22 S V=V_"E22" D D23^V3NSTE Q
ED23 S V=V_"E23" D D24^V3NSTE Q
ED24 S V=V_"E24" D D25^V3NSTE Q
ED25 S V=V_"E25" D D26^V3NSTE Q
ED26 S V=V_"E26" D D27^V3NSTE Q
ED27 S V=V_"E27" D D28^V3NSTE Q
ED28 S V=V_"E28" D D29^V3NSTE Q
ED29 S V=V_"E29" Q
D6612 S V=V_I_J_" "
