V4TP24 ;IW-KO-YS-TS,VV4TP,MVTS V9.10;15/7/96;PART-94 Transaction
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1994-1996
 ;
 W !!,"152---V4TP24: 2 Transactions tests  -4-"
 ;
 W !!,"TSTART with transparameters"
 W !,"   with a restart before TCOMMIT or TROLLBACK",!
 ;
1 S ^ABSN="40915",^ITEM="IV-915  1. TSTART lname:SERIAL  ... TRESTART ... TROLLBACK!2. TSTART lname:SERIAL  ... TCOMMIT"
 S ^NEXT="2^V4TP24,V4TP31^VV4TP" D ^V4PRETP2
 JOB 11^V4TPE24::60 S WAIT=WAIT_$T
 JOB 12^V4TPE24::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)^VC^VD(1)VAVB(1)VCVD(1)10/#1^VA^VB(1)VAVB(1)VCVD(1)11/#1^VA^VA^VB(1)^VB(1)VAVAVB(1)VB(1)VCVD(1)11/#1^VA^VB(1)VAVAVB(1)VB(1)VCVD(1)00/#2^VA^VA^VB(1)^VB(1)VAVB(1)10/#2^VA^VA^VB(1)^VB(1)VAVB(1)00/*111/#M^VA^VA^VB(1)^VB(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
2 S ^ABSN="40916",^ITEM="IV-916  1. TSTART (lname,lname,lname):SERIAL  ... TRESTART ... TROLLBACK!2. TSTART (lname,lname)  ... TROLLBACK"
 S ^NEXT="3^V4TP24,V4TP31^VV4TP" D ^V4PRETP2
 JOB 21^V4TPE24::60 S WAIT=WAIT_$T
 JOB 22^V4TPE24::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)^VC^VD(1)VAVB(1)VCVD(1)10/#1^VA^VB(1)VAVB(1)VC11/#1^VA^VB(1)VAVB(1)VCVCVD(1)00/#2^VA^VB(1)^VC^VD(1)VCVD(1)10/#2^VA^VB(1)VCVD(1)00/*111/#M^VA^VB(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
3 S ^ABSN="40917",^ITEM="IV-917  1. TSTART *:SERIAL  ... TRESTART ... HALT!2. TSTART ():SERIAL  ... TCOMMIT"
 S ^NEXT="4^V4TP24,V4TP31^VV4TP" D ^V4PRETP2
 JOB 31^V4TPE24::60 S WAIT=WAIT_$T
 JOB 32^V4TPE24::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VC^VD(1)VCVD(1)10/#111/#1^VC^VD(1)VCVD(1)11/#2^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)10/#2^VA(1)^VB(1,2)^VC(2)^VD(1,2)VA(1)VB(1,2)VC(2)VD(1,2)00/*111/#M^VA(1)^VB(1,2)^VC(2)^VD(1,2)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
4 S ^ABSN="40918",^ITEM="IV-918  1. TSTART ():SERIAL  ... TRESTART ... TCOMMIT!2. TSTART lname  ... TRESTART ... TROLLBACK"
 S ^NEXT="5^V4TP24,V4TP31^VV4TP" D ^V4PRETP2
 JOB 41^V4TPE24::60 S WAIT=WAIT_$T
 JOB 42^V4TPE24::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)VAVB(1)10/#1VAVB(1)11/#1^va(1)^vb(2)^vc(1,2)^vd(2)VAva(1)VB(1)vb(2)vc(1,2)vd(2)00/#2^VA^va(1)^VB(1)^vb(2)^vc(1,2)^vd(2)VAVB(1)10/#2^va(1)^vb(2)^vc(1,2)^vd(2)VA11/#2^va(1)^vb(2)^vc(1,2)^vd(2)VAVCVD(1)00/*111/#M^va(1)^vb(2)^vc(1,2)^vd(2)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
5 S ^ABSN="40919",^ITEM="IV-919  1. TSTART lname:SERIAL  ... TRESTART ... TCOMMIT!2. TSTART lname  ... TRESTART ... TCOMMIT"
 S ^NEXT="V4TP31^VV4TP" D ^V4PRETP2
 JOB 51^V4TPE24::60 S WAIT=WAIT_$T
 JOB 52^V4TPE24::60 S WAIT=WAIT_$T
 LOCK -^V(1) HANG 1 LOCK -^V(2) HANG 1
 L  F  Q:$$^V4GETSM
 S ^VCORR="#1^VA^VB(1)VAVB(1)10/#1VB(1)11/#1^VA^VB(1)VAVB(1)VB(1)11/#1^VA^VB(1)VAVB(1)VB(1)00/#2^VA^VA^VB(1)^VB(1)VAVB(1)10/#2^VA^VB(1)VA11/#2^VA^VB(1)^VC^VD(1)VAVCVD(1)00/*111/#M^VA^VB(1)^VC^VD(1)00/"
 D ^V4TPCHKM D ^V4GETCOM D ^VEXAMINE
 ;
END W !!,"End of 152 --- V4TP24",!
 Q
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
