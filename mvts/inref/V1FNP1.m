V1FNP1 ;IW-YS-TS,V1FN,MVTS V9.10;15/6/96;FUNCTION $PIECE -1-
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1978-1996
 W !!,"101---V1FNP1: $PIECE function -1-",! W:$Y>55 #
 W !,"$PIECE(expr1,expr2,intexpr3)",! W:$Y>55 #
315 W !,"I-315  substring specified by intexpr3 exist intexpr1"
3151 S ^ABSN="11387",^ITEM="I-315.1  intexpr3=1",^NEXT="3152^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$PIECE("ABCBD","B",1) S ^VCORR="A" D ^VEXAMINE
3152 S ^ABSN="11388",^ITEM="I-315.2  intexpr3=2",^NEXT="3153^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("ABCBD","B",2) S ^VCORR="C" D ^VEXAMINE
3153 S ^ABSN="11389",^ITEM="I-315.3  intexpr3=3",^NEXT="3154^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("ABCBD","B",3) S ^VCORR="D" D ^VEXAMINE
3154 S ^ABSN="11390",^ITEM="I-315.4  intexpr3=4",^NEXT="3155^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCBD","B",4) S ^VCORR="" D ^VEXAMINE
3155 S ^ABSN="11391",^ITEM="I-315.5  expr1 contains unary operator",^NEXT="316^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P(+"-1.5E",".",2) S ^VCORR="5" D ^VEXAMINE
 ;
316 W !,"I-316  substring specified by intexpr3 does not exist intexpr1"
3161 S ^ABSN="11392",^ITEM="I-316.1  intexpr3=1",^NEXT="3162^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("ABCBD","F",1) S ^VCORR="ABCBD" D ^VEXAMINE
3162 S ^ABSN="11393",^ITEM="I-316.2  intexpr3>$L(expr1)",^NEXT="317^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCBD","bc",8) S ^VCORR="" D ^VEXAMINE
 ;
317 W !,"I-317  intexpr3<0"
 S ^ABSN="11394",^ITEM="I-317  intexpr3<0",^NEXT="318^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCBD","B",-4) S ^VCORR="" D ^VEXAMINE
 ;
318 W !,"I-318  intexpr3=0"
 S ^ABSN="11395",^ITEM="I-318  intexpr3=0",^NEXT="319^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCBD","B",0) S ^VCORR="" D ^VEXAMINE
 ;
319 W !,"I-319  intexpr3>$LENGTH(expr1)"
 S ^ABSN="11396",^ITEM="I-319  intexpr3>$LENGTH(expr1)",^NEXT="320^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("A""B""C""D""E","""",10) S ^VCORR="" D ^VEXAMINE
 ;
320 W !,"I-320  $LENGTH(expr1)<$LENGTH(expr2)"
3201 S ^ABSN="11397",^ITEM="I-320.1  intexpr3=1",^NEXT="3202^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("@@@@","@@@@@",1) S ^VCORR="@@@@" D ^VEXAMINE
3202 S ^ABSN="11398",^ITEM="I-320.2  intexpr3=2",^NEXT="321^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("@@@@","@@@@@",2) S ^VCORR="" D ^VEXAMINE
 ;
321 W !,"I-321  expr1=expr2"
 S ^ABSN="11399",^ITEM="I-321  expr1=expr2",^NEXT="322^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("789","789",1) S ^VCORR="" D ^VEXAMINE
 ;
322 W !,"I-322  intexpr3>255"
 S ^ABSN="11400",^ITEM="I-322  intexpr3>255",^NEXT="323^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P(1111,1,99999999) S ^VCORR="" D ^VEXAMINE
 ;
323 W !,"I-323  intexpr3 is non-intexpr numeric"
3231 S ^ABSN="11401",^ITEM="I-323.1  3.9999",^NEXT="3232^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P(112131419,"1",3.9999) S ^VCORR="2" D ^VEXAMINE
3232 S ^ABSN="11402",^ITEM="I-323.2  3.49999",^NEXT="324^V1FNP1,V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P(0112118114,11,3.49999) S ^VCORR="8" D ^VEXAMINE
 ;
324 W !,"I-324  Control characters are used as delimiters (expr2)"
 S ^ABSN="11403",^ITEM="I-324  Control characters are used as delimiters (expr2)",^NEXT="V1FNP2^V1FN,V1AC^VV1" D ^V1PRESET
 S X="A"_$C(9)_"B"_$C(9)_"C",Y=$C(9) S ^VCOMP=$P(X,Y,2) S ^VCORR="B" D ^VEXAMINE
 ;
END W !!,"End of 101---V1FNP1",!
 K  Q
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
