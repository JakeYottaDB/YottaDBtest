V1FNP3 ;IW-YS-TS,V1FN,MVTS V9.10;15/6/96;FUNCTION $PIECE -3-
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1978-1996
 W !!,"103---V1FNP3: $PIECE function -3-",!
 ;
331 W !!,"$PIECE(expr1,expr2,intexpr3,intexpr4)",!
 W !,"I-331  intexpr4 is positive integer"
3311 S ^ABSN="11412",^ITEM="I-331.1  intexpr3<intexpr4",^NEXT="3312^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("ABCBD","B",2,3) S ^VCORR="CBD" D ^VEXAMINE
3312 S ^ABSN="11413",^ITEM="I-331.2  expr1 is intlit",^NEXT="3313^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P(0002304501,00,002,03),^VCORR="4501" D ^VEXAMINE
3313 S ^ABSN="11414",^ITEM="I-331.3  intexpr3<-1",^NEXT="3314^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("ABCBD","B",-3,2) S ^VCORR="ABC" D ^VEXAMINE
3314 S ^ABSN="11415",^ITEM="I-331.4  intexpr4>$L(expr1)",^NEXT="3315^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("ABCBD","B",2,100) S ^VCORR="CBD" D ^VEXAMINE
3315 S ^ABSN="11416",^ITEM="I-331.5  $F(expr1,expr2)=0",^NEXT="3316^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCDE",3,4,5) S ^VCORR="" D ^VEXAMINE
3316 S ^ABSN="11417",^ITEM="I-331.6  expr1 contains _ binary operator",^NEXT="3317^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("AB"_2_"BD","B",2,2) S ^VCORR=2 D ^VEXAMINE
3317 S ^ABSN="11418",^ITEM="I-331.7  expr1 is an empty string",^NEXT="3318^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("","B",2,5) S ^VCORR="" D ^VEXAMINE
3318 S ^ABSN="11419",^ITEM="I-331.8  expr2 is an empty string",^NEXT="3319^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCBD","",2,5) S ^VCORR="" D ^VEXAMINE
3319 S ^ABSN="11420",^ITEM="I-331.9  expr1 and expr2 are empty strings",^NEXT="332^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123",^VCOMP=$P("","",2,5),^VCORR="" D ^VEXAMINE
 ;
332 W !,"I-332  intexpr4 is non-integer"
3321 S ^ABSN="11421",^ITEM="I-332.1  2.5",^NEXT="3322^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P(10.05,0.0,1.99999,2.5) S ^VCORR="10." D ^VEXAMINE
3322 S ^ABSN="11422",^ITEM="I-332.2  02.4560000",^NEXT="333^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P(12.324E2,2.00,1.0,02.4560000),^VCORR="123" D ^VEXAMINE
 ;
333 W !,"I-333  intexpr3>intexpr4"
 S ^ABSN="11423",^ITEM="I-333  intexpr3>intexpr4",^NEXT="334^V1FNP3,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$P("ABCBD","B",3,2) S ^VCORR="" D ^VEXAMINE
 ;
334 W !,"I-334  intexpr4>255"
 S ^ABSN="11424",^ITEM="I-334  intexpr4>255",^NEXT="V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$P("A B C D E F G "," ",3,9876545) S ^VCORR="C D E F G " D ^VEXAMINE
 ;
END W !!,"End of 103---V1FNP3",!
 K  Q
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
