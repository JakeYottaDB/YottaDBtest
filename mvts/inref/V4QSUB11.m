V4QSUB11 ;IW-KO-YS-TS,V4QSUB,MVTS V9.10;15/6/96;PART-94
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1994-1996
 ;
 W !!,"64---V4QSUB11:  $QSUBSCRIPT function  -11-"
 ;
 W !!,"$QL(namevalue)'<intexpr>0"
 ;
 W !!,"1 subscript"
 ;
1 S ^ABSN="40471",^ITEM="IV-471  subscript is an integer number"
 S ^NEXT="2^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(9000000000)",1)
 S ^VCORR="9000000000" D ^VEXAMINE
 ;
2 S ^ABSN="40472",^ITEM="IV-472  subscript is a number"
 S ^NEXT="3^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$qs("^V1234567(-.0098765)",1)
 S ^VCORR="-.0098765" D ^VEXAMINE
 ;
3 S ^ABSN="40473",^ITEM="IV-473  subscript is a string"
 S ^NEXT="4^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$qs("^V0000000(""009876"")",1)
 S ^VCORR="009876" D ^VEXAMINE
 ;
4 S ^ABSN="40474",^ITEM="IV-474  subscript contains a "" character"
 S ^NEXT="5^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(""ABC""""DEF"")",1)
 S ^VCORR="ABC""DEF" D ^VEXAMINE
 ;
5 S ^ABSN="40475",^ITEM="IV-475  subscript contains "" characters"
 S ^NEXT="6^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$qs("^VVVVVVVV(""AGD""""M"""""")",1)
 S ^VCORR="AGD""M""" D ^VEXAMINE
 ;
 W !!,"2 subscripts"
 ;
6 S ^ABSN="40476",^ITEM="IV-476  subscript is an integer number"
 S ^NEXT="7^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(8364,""DG"")",1)
 S ^VCORR="8364" D ^VEXAMINE
 ;
7 S ^ABSN="40477",^ITEM="IV-477  subscript is a number"
 S ^NEXT="8^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(-.0034885,384858)",1)
 S ^VCORR="-.0034885" D ^VEXAMINE
 ;
8 S ^ABSN="40478",^ITEM="IV-478  subscript are numbers"
 S ^NEXT="9^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(.00000023455,38475.374)",2)
 S ^VCORR="38475.374" D ^VEXAMINE
 ;
9 S ^ABSN="40479",^ITEM="IV-479  subscript is a string"
 S ^NEXT="10^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(9999,""##$%%##"")",2)
 S ^VCORR="##$%%##" D ^VEXAMINE
 ;
10 S ^ABSN="40480",^ITEM="IV-480  subscript are strings"
 S ^NEXT="11^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$qs("^V(""-123E3"",""39394E4"")",1)
 S ^VCORR="-123E3" D ^VEXAMINE
 ;
11 S ^ABSN="40481",^ITEM="IV-481  subscript contains a "" character"
 S ^NEXT="12^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(""A""""B"",234)",1)
 S ^VCORR="A""B" D ^VEXAMINE
 ;
12 S ^ABSN="40482",^ITEM="IV-482  subscript contains "" characters"
 S ^NEXT="13^V4QSUB11,V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(1234,""AA""""""""BB"")",2)
 S ^VCORR="AA""""BB" D ^VEXAMINE
 ;
13 S ^ABSN="40483",^ITEM="IV-483  5 subscripts"
 S ^NEXT="V4QSUB12^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("^V(""A"",""B"",1,2,3)",3)
 S ^VCORR="1" D ^VEXAMINE
 ;
END W !!,"End of 64 --- V4QSUB11",!
 K  Q
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
