V1FNE3 ;IW-YS-TS,V1FN,MVTS V9.10;15/6/96;FUNCTION $EXTRACT -3-
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1978-1996
 W !!,"94---V1FNE3: $EXTRACT function -3-" W:$Y>55 #
 ;
 W !!,"$EXTRACT(expr1,intexpr2,intexpr3)",! W:$Y>55 #
281 W !,"I-281  intexpr2<intexpr3"
2811 S ^ABSN="11282",^ITEM="I-281.1  intexpr3<$L(expr1)",^NEXT="2812^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",26,28) S ^VCORR="Z12" D ^VEXAMINE
 ;
2812 S ^ABSN="11283",^ITEM="I-281.2  intexpr contains lvn",^NEXT="2813^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S VCOMP="" F I=1:4:36 S VCOMP=VCOMP_$E("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",I,I+1)
 S ^VCOMP=VCOMP,^VCORR="ABEFIJMNQRUVYZ3478" D ^VEXAMINE
 ;
2813 S ^ABSN="11284",^ITEM="I-281.3  intexpr3>$L(expr1)",^NEXT="2814^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",1,256)
 S ^VCORR="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890" D ^VEXAMINE
 ;
2814 S ^ABSN="11285",^ITEM="I-281.4  intexpr2<0",^NEXT="2815^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S A="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",^VCOMP=$E(A,-5,"5E.AC"),^VCORR="ABCDE" D ^VEXAMINE
 ;
2815 S ^ABSN="11286",^ITEM="I-281.5  intexpr2<0 and intexpr3>$L(expr1)",^NEXT="2816^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E("ABCDEFGHIJ",-1,"12.99ABC") S ^VCORR="ABCDEFGHIJ" D ^VEXAMINE
 ;
2816 S ^ABSN="11287",^ITEM="I-281.6  expr1 is function",^NEXT="282^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E($EXTRACT("ABCDEFGHIJ",3,8),-1,"3.99ABC") S ^VCORR="CDE" D ^VEXAMINE
 ;
282 W !,"I-282  intexpr2=intexpr3"
2821 S ^ABSN="11288",^ITEM="I-282.1  intexpr=1",^NEXT="2822^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E("PQRSTUVWXYZ1234567890",1,1) S ^VCORR="P" D ^VEXAMINE
2822 S ^ABSN="11289",^ITEM="I-282.2  1<intexpr<$L(expr1)",^NEXT="2823^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E(-000723.89400E-01,3,3) S ^VCORR="2" D ^VEXAMINE
2823 S ^ABSN="11290",^ITEM="I-282.3  intexpr=$L(expr1)",^NEXT="2824^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP=$E("ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",36,36),^VCORR="0" D ^VEXAMINE
2824 S ^ABSN="11291",^ITEM="I-282.4  intexpr=0",^NEXT="2825^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$E("ABCDEFGIJKL567890",0,0) S ^VCORR="" D ^VEXAMINE
2825 S ^ABSN="11292",^ITEM="I-282.5  intexpr<-1",^NEXT="2826^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$E("ABC90",-1,-1) S ^VCORR="" D ^VEXAMINE
2826 S ^ABSN="11293",^ITEM="I-282.6  intexpr>$L(expr1)",^NEXT="2827^V1FNE3,V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$E("ABC90",77,77) S ^VCORR="" D ^VEXAMINE
2827 S ^ABSN="11294",^ITEM="I-282.7  expr1 is an empty string and intexpr=1",^NEXT="V1FNE4^V1FN,V1AC^VV1" D ^V1PRESET
 S ^VCOMP="123" S ^VCOMP=$E("",1,1) S ^VCORR="" D ^VEXAMINE
 ;
END W !!,"End of 94---V1FNE3",!
 K  Q
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
