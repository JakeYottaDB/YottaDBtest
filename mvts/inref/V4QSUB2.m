V4QSUB2 ;IW-KO-YS-TS,V4QSUB,MVTS V9.10;15/6/96;PART-94
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1994-1996
 ;
 W !!,"55---V4QSUB2:  $QSUBSCRIPT function  -2-"
 ;
 W !!,"2 subscripts"
 ;
1 S ^ABSN="40405",^ITEM="IV-405  subscript is an integer number"
 S ^NEXT="2^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("V1234567(90000000,""A"")",0)
 S ^VCORR="V1234567" D ^VEXAMINE
 ;
2 S ^ABSN="40406",^ITEM="IV-406  subscript is a number"
 S ^NEXT="3^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$Qs("ZZZZZZZZ(123.393,-.000322)",-0)
 S ^VCORR="ZZZZZZZZ" D ^VEXAMINE
 ;
3 S ^ABSN="40407",^ITEM="IV-407  subscript are numbers"
 S ^NEXT="4^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("V(-.0000001,19293.999)",0)
 S ^VCORR="V" D ^VEXAMINE
 ;
4 S ^ABSN="40408",^ITEM="IV-408  subscript is a string"
 S ^NEXT="5^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("%AAAAAAA(""ABCDEF"",-123)",0)
 S ^VCORR="%AAAAAAA" D ^VEXAMINE
 ;
5 S ^ABSN="40409",^ITEM="IV-409  subscript are strings"
 S ^NEXT="6^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$qs("%ZZZZZZZ(""ABCDEF"",""abcdef"")",0)
 S ^VCORR="%ZZZZZZZ" D ^VEXAMINE
 ;
6 S ^ABSN="40410",^ITEM="IV-410  subscript contains a "" character"
 S ^NEXT="7^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$Qs("VVVV(""123""""4"",""zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"")",0)
 S ^VCORR="VVVV" D ^VEXAMINE
 ;
7 S ^ABSN="40411",^ITEM="IV-411  subscript contains "" characters"
 S ^NEXT="8^V4QSUB2,V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$qs("A00000Z("""""""","""""""""""")",0)
 S ^VCORR="A00000Z" D ^VEXAMINE
 ;
8 S ^ABSN="40412",^ITEM="IV-412  5 subscripts"
 S ^NEXT="V4QSUB3^V4QSUB,V4SVQ^VV4" D ^V4PRESET K
 S ^VCOMP=$QS("H0987654(""@@@"",""~"",1234,""]]]]]"",-.0000002)",0)
 S ^VCORR="H0987654" D ^VEXAMINE
 ;
END W !!,"End of 55 --- V4QSUB2",!
 K  Q
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
