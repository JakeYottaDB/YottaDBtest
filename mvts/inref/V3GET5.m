V3GET5 ;IW-KO-YS-TS,V3GET,MVTS V9.10;15/6/96;PART-90
 ;COPYRIGHT MUMPS SYSTEMS LABORATORY 1990-1996
 W !!,"5---V3GET5: $GET function -5-"
 ;
1 S ^ABSN="30068",^ITEM="III-68  gvn has subscript and siblings have no values"
 S ^NEXT="2^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K ^V3GET
 S ^V3GET("abc",345.89,123)="####"
 S ^V3GET("abc",345.89,123,-2)="####"
 S ^V3GET("abc",45.89,3939)="12"
 S ^V3GET("abc",45.89,3939,-1)="12"
 S ^V3GET("abc",5.89,"abc")="abc"
 S ^V3GET("abc",5.89,"abc",1)="abc"
 S ^VCOMP=$G(^V3GET("abc",45.89,3939))
 S ^VCORR="12" D ^VEXAMINE K ^V3GET
 ;
 W !!,"Relation to the value"
 ;
 W !!,"$GET(lvn)",!
 ;
2 S ^ABSN="30069",^ITEM="III-69  Value is an empty string"
 S ^NEXT="3^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K
 S B00(7.089)=""
 S ^VCOMP=$G(B00(7.089))
 S ^VCORR="" D ^VEXAMINE
 ;
3 S ^ABSN="30070",^ITEM="III-70  value is an integer"
 S ^NEXT="4^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K ^V3GET
 S V3GET("FAA","FAIL SAFE")=1234.567E+5
 S ^VCOMP=$G(V3GET("FAA","FAIL SAFE"))
 S ^VCORR="123456700" D ^VEXAMINE
 ;
4 S ^ABSN="30071",^ITEM="III-71  value is a number"
 S ^NEXT="5^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K
 S B1028(+"00648.74800E-2")=-1293.839E-4
 S ^VCOMP=$G(B1028(6.48748))
 S ^VCORR="-.1293839" D ^VEXAMINE
 ;
5 S ^ABSN="30072",^ITEM="III-72  value is a 255 characters string"
 S ^NEXT="6^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K ^V3GET
 S A="" F I=1:1:51 S A=A_"ABCDE"
 S YELLO("8494")=A
 S ^VCOMP=$G(YELLO(8494))
 S ^VCORR="ABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDE"
 S ^VCORR=^VCORR_"ABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDE"
 D ^VEXAMINE
 ;
6 S ^ABSN="30073",^ITEM="III-73  value contains control characters"
 S ^NEXT="7^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K
 S CNTL="" F I=0:1:31 S CNTL=CNTL_$C(I)
 S CNTL=CNTL_$C(13,10)_"abc"
 S ^VCOMP=$G(CNTL)
 S ^VCORR=$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,13,10)_"abc"
 D ^VEXAMINE
 ;
 W !!,"$GET(gvn)",!
 ;
7 S ^ABSN="30074",^ITEM="III-74  Value is an empty string"
 S ^NEXT="8^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K
 S ^V3B00(7.089)=""
 S ^VCOMP=$G(^V3B00(7.089))
 S ^VCORR="" D ^VEXAMINE K ^V3B00
 ;
8 S ^ABSN="30075",^ITEM="III-75  value is an integer"
 S ^NEXT="9^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K ^V3GET
 S ^V3GET("FAA","FAIL SAFE")=1234.567E+5
 S ^VCOMP=$G(^V3GET("FAA","FAIL SAFE"))
 S ^VCORR="123456700" D ^VEXAMINE K ^V3GET
 ;
9 S ^ABSN="30076",^ITEM="III-76  value is a number"
 S ^NEXT="10^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K
 S ^V3B1028(+"00648.74800E-2")=-1293.839E-4
 S ^VCOMP=$G(^V3B1028(6.48748))
 S ^VCORR="-.1293839" D ^VEXAMINE K ^V3B1028
 ;
10 S ^ABSN="30077",^ITEM="III-77  value is a 255 characters string"
 S ^NEXT="11^V3GET5,V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K ^V3GET
 S A="" F I=1:1:51 S A=A_"ABCDE"
 S ^V3YELLO("8494")=A
 S ^VCOMP=$G(^V3YELLO(8494))
 S ^VCORR="ABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDE"
 S ^VCORR=^VCORR_"ABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDEABCDE"
 D ^VEXAMINE K ^V3YELLO
 ;
11 S ^ABSN="30078",^ITEM="III-78  value contains control characters"
 S ^NEXT="V3GET6^V3GET,V3TR^VV3" D ^V3PRESET K
 S CNTL="" F I=0:1:31 S CNTL=CNTL_$C(I)
 S ^V3CNTL=CNTL_$C(13,10)_"abc"
 S ^VCOMP=$G(^V3CNTL)
 S ^VCORR=$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,13,10)_"abc"
 D ^VEXAMINE K ^V3CNTL
 ;
END W !!,"End of 5 --- V3GET5",!
 K  K ^V3GET,^V3CNTL,^V3YELLO,^V3B1028,^V3B00 Q
 ;
SUM S SUM=0 F I=1:1 S L=$T(+I) Q:L=""  F K=1:1:$L(L) S SUM=SUM+$A(L,K)
 Q
